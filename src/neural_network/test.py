from network import NeuralNetwork

weights = [
    [ #layer 1
       [5.141731, 4.995516, 7.521773, -2.586270, -3.534096],
       [-0.908193, 5.810476, -8.354974, 0.450234, 6.348236],
       [0.215247, 0.454888, -5.307294, 7.283024, 5.508942]
    ],
    [ #layer 2
       [8.612943, -1.033114, -11.436887, 7.801981], #w1
       [3.058107, -2.682118, -9.106355, 1.007801], #w2
       [-9.490444, 1.513688, 1.738255, 1.641497], #w3
       [2.832772, -9.880069, 9.168439, -6.673450] #w4
    ]
]

data = [
    {
        'input': [2.0, 0.0, 0.0, 0.0],
        'output': [0.0, 0.0, 1.0, 0.0]
    },     
    {
        'input': [2.0, 0.0, 0.0, 1.0],
        'output': [0.0, 0.0, 1.0, 0.0]
    },              
    {
        'input': [2.0, 0.0, 1.0, 1.0],
        'output': [1.0, 0.0, 0.0, 0.0]
    },
    {
        'input': [2.0, 0.0, 1.0, 2.0],
        'output': [1.0, 0.0, 0.0, 0.0]
    },      
    {
        'input': [2.0, 1.0, 0.0, 2.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },
    {
        'input': [2.0, 1.0, 0.0, 1.0],
        'output': [1.0, 0.0, 0.0, 0.0]
    },
    ##################################   
    {
        'input': [1.0, 0.0, 0.0, 0.0],
        'output': [0.0, 0.0, 1.0, 0.0]
    },     
    {
        'input': [1.0, 0.0, 0.0, 1.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },              
    {
        'input': [1.0, 0.0, 1.0, 1.0],
        'output': [1.0, 0.0, 0.0, 0.0]
    },
    {
        'input': [1.0, 0.0, 1.0, 2.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },      
    {
        'input': [1.0, 1.0, 0.0, 2.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },
    {
        'input': [1.0, 1.0, 0.0, 1.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },
    ##################################   
    {
        'input': [0.0, 0.0, 0.0, 0.0],
        'output': [0.0, 0.0, 1.0, 0.0]
    },     
    {
        'input': [0.0, 0.0, 0.0, 1.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },              
    {
        'input': [0.0, 0.0, 1.0, 1.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },
    {
        'input': [0.0, 0.0, 1.0, 2.0],
        'output': [0.0, 1.0, 0.0, 0.0]
    },      
    {
        'input': [0.0, 1.0, 0.0, 2.0],
        'output': [0.0, 1.0, 0.0, 0.0]
    },
    {
        'input': [0.0, 1.0, 0.0, 1.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },              
]

test_data = [
    {
        'input': [2.0, 1.0, 1.0, 1.0],
        'output': [1.0, 0.0, 0.0, 0.0]
    },   
    {
        'input': [1.0, 1.0, 1.0, 2.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },       
    {
        'input': [0.0, 0.0, 0.0, 0.0],
        'output': [0.0, 0.0, 1.0, 0.0]
    },         
    {
        'input': [0.0, 1.0, 1.0, 1.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },      
    {
        'input': [2.0, 0.0, 1.0, 3.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },       
    {
        'input': [2.0, 1.0, 0.0, 3.0],
        'output': [0.0, 0.0, 0.0, 1.0]
    },     
    {
        'input': [0.0, 1.0, 0.0, 3.0],
        'output': [0.0, 1.0, 0.0, 0.0]
    },                                                                          
]

if __name__ == "__main__":
    network = NeuralNetwork((4, 3, 4))
    network.teach(data, max_retries=50000)
    print 'Check study'
    network.test(data)
    print 'Test data'
    network.test(test_data)